{{ 'product-info-modal.css' | asset_url | stylesheet_tag }}
<script src="{{ 'product-info-modal.js' | asset_url }}" defer></script>

{% if product %}
  <div class="product-info-toggle" id="product-info-toggle-{{ block.id }}">
    <button 
      class="product-info-button" 
      id="toggle-btn-{{ block.id }}"
      style="background-color: {{ block.settings.button_color }}; color: {{ block.settings.text_color }};"
    >
      {{ block.settings.button_text }}
    </button>
  </div>
{% else %}
  <div class="product-info-error">
    <strong>Notice:</strong> This extension is only for product page
  </div>
{% endif %}

{% if product %}
  <div 
    class="product-info-overlay" 
    id="overlay-{{ block.id }}"
    style="position: fixed !important; z-index: 2147483646 !important; pointer-events: auto !important;"
  ></div>

  <div 
    class="product-info-modal" 
    id="modal-{{ block.id }}"
    style="background-color: {{ block.settings.info_bg_color }}; position: fixed !important; z-index: 2147483647 !important; pointer-events: auto !important;"
  >
    <button 
      class="close-modal" 
      id="close-btn-{{ block.id }}"
      aria-label="Close modal"
    >
      &times;
    </button>

    <h3>Product Info</h3>
    
    <div class="product-info-details">
      <p>
        <strong>Dev Name:</strong> Phan Thanh TÃ¹ng
      </p>

      <p>
        <strong>Title:</strong> {{ product.title }}
      </p>
      
      <p>
        <strong>Price:</strong> 
        <span class="product-price">{{ product.price | money }}</span>
      </p>
      
      {% if product.available %}
        <p>
          <strong>Availability:</strong> 
          <span class="in-stock"> In Stock</span>
        </p>
      {% else %}
        <p>
          <strong>Availability:</strong> 
          <span class="out-of-stock">Out of Stock</span>
        </p>
      {% endif %}
      
      {% if product.type %}
        <p>
          <strong>Type:</strong> {{ product.type }}
        </p>
      {% endif %}
      
      {% if product.tags.size > 0 %}
        <p>
          <strong>Tags:</strong> 
          <span class="tags">{{ product.tags | join: ', ' }}</span>
        </p>
      {% endif %}
      
    </div>
  </div>

  <script>
    if (typeof initProductInfoModal !== 'undefined') {
      initProductInfoModal('{{ block.id }}');
    } else {
      window.addEventListener('load', function() {
        initProductInfoModal('{{ block.id }}');
      });
    }
  </script>
{% endif %}

{% schema %}
{
  "name": "Training Team H Tung",
  "target": "section",
  "settings": [
    {
      "type": "text",
      "id": "button_text",
      "label": "Button Text",
      "default": "View Product Info"
    },
    {
      "type": "color",
      "id": "button_color",
      "label": "Button Color",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Button Text Color",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "info_bg_color",
      "label": "Modal Background",
      "default": "#ffffff"
    }
  ]
}
{% endschema %}
